<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tc.mapper.ExamPlanMapper">

    <resultMap id="examMap" type="com.tc.entity.ExamPlan">
        <id property="id" column="ID"></id>
        <result property="paperId" column="paper_ID"></result>
        <result property="classId" javaType="String" column="class_ID" jdbcType="VARCHAR"></result>
        <result property="examStartDatetime" javaType="String" column="start_datetime" jdbcType="DATE"></result>
        <result property="examEndDatetime" javaType="String" column="end_datetime" jdbcType="DATE"/>
    </resultMap>
    <select id="getExamBe" parameterType="java.util.Map" resultMap="examMap">
        SELECT
        tep.ID,
        tep.paper_ID,
        tep.class_ID,
        tep.start_datetime,
        tep.end_datetime
        from
        (tab_student ts
        LEFT JOIN tab_class tc ON ts.Class_NO=tc.ID)
        LEFT JOIN tab_exam_plan tep ON tc.ID=tep.class_ID
        WHERE 1=1
        <if test="nowDatetime != null and nowDatetime != ''">
            AND tep.start_datetime>#{nowDatetime}
        </if>
        <if test="studentNO != null and studentNO != ''">
            AND ts.Student_NO=#{studentNO}
        </if>
    </select>

    <!--增加考试安排-->
    <insert id="insertExamPlan" parameterType="java.util.Map">
        INSERT  INTO tab_exam_plan
        (exam_name,subject_ID,start_datetime,end_datetime,create_datetime,teacher_ID)
        VALUES
        (#{exam_name},#{subject_ID},#{StartDt},#{EndDt},#{createDt},#{teacher})
    </insert>
</mapper>